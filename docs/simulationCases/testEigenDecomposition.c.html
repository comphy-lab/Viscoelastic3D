<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <!-- Eliminate FOUC (Flash of Unstyled Content) and FOUT (Flash of Incorrect Theme) -->
  <script>
    (function() {
  try {
    // Apply the theme as quickly as possible to avoid flash
    let saved;
    try {
      saved = localStorage.getItem('theme');
    } catch (storageError) {
      // Handle localStorage access errors (private browsing, cookies disabled)
      console.warn('Unable to access localStorage:', storageError);
    }
<a id="" href="#"></a>
    let prefersDark = false;
    try {
      prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    } catch (mediaError) {
      // Handle matchMedia access errors (unsupported browsers)
      console.warn('Unable to check media query:', mediaError);
    }
<a id="" href="#"></a>
    const theme = saved ? saved : (prefersDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
    // Add theme class for CSS targeting
    document.documentElement.classList.add(theme + '-theme');
    // Mark when theme is set for CSS transitions
    document.documentElement.classList.add('theme-set');
  } catch (error) {
    // Fallback for any other unexpected errors
    console.warn('Theme initialization failed:', error);
    // Apply default theme as fallback
    try {
      document.documentElement.setAttribute('data-theme', 'light');
      document.documentElement.classList.add('light-theme');
      document.documentElement.classList.add('theme-set');
    } catch (fallbackError) {
      // Silent catch for extreme cases
      console.error('Critical theme fallback failed:', fallbackError);
    }
  }
})();
  </script>
<a id="" href="#"></a>
<a id="" href="#"></a>
  <!-- No-JS fallback for theme and critical theming styles -->
  <style>
    /* Default light theme variables */
    :root {
      /* Base colors */
      --color-background: #fff;
      --color-text: #333;
      --color-primary: #0066cc;
      --color-secondary: #036;
      --color-accent: #0099ff;
<a id="" href="#"></a>
      /* UI elements */
      --color-header-bg: #f5f5f5;
      --color-footer-bg: #2d2e33;
      --color-border: #e0e0e0;
      --color-input-bg: #f9f9f9;
<a id="" href="#"></a>
      /* Component colors */
      --color-preloader-bg: #ffffff;
      --color-loader: #0066cc;
      --color-card-bg: #ffffff;
      --color-code-bg: #f5f5f5;
    }
<a id="" href="#"></a>
    /* Dark theme variables applied via media query when JS is disabled */
    @media (prefers-color-scheme: dark) {
      :root:not(.theme-set) {
        /* Base colors - dark mode */
        --color-background: #1a1a1a;
        --color-text: #f5f5f5;
        --color-primary: #4d9fff;
        --color-secondary: #88ccff;
        --color-accent: #00bfff;
<a id="" href="#"></a>
        /* UI elements - dark mode */
        --color-header-bg: #121212;
        --color-footer-bg: #121212;
        --color-border: #333;
        --color-input-bg: #2d2d2d;
<a id="" href="#"></a>
        /* Component colors - dark mode */
        --color-preloader-bg: #1a1a1a;
        --color-loader: #4d9fff;
        --color-card-bg: #222;
        --color-code-bg: #2d2d2d;
      }
    }
<a id="" href="#"></a>
    /* When JS sets the theme explicitly via data attribute */
    [data-theme="dark"] {
      /* Base colors - dark mode */
      --color-background: #1a1a1a;
      --color-text: #f5f5f5;
      --color-primary: #4d9fff;
      --color-secondary: #88ccff;
      --color-accent: #00bfff;
<a id="" href="#"></a>
      /* UI elements - dark mode */
      --color-header-bg: #121212;
      --color-footer-bg: #121212;
      --color-border: #333;
      --color-input-bg: #2d2d2d;
<a id="" href="#"></a>
      /* Component colors - dark mode */
      --color-preloader-bg: #1a1a1a;
      --color-loader: #4d9fff;
      --color-card-bg: #222;
      --color-code-bg: #2d2d2d;
    }
<a id="" href="#"></a>
    /* Prevent transition flashes during initial load */
    html:not(.transitions-enabled) * {
      transition: none !important;
    }
<a id="" href="#"></a>
    /* Apply theme to preloader and early elements */
    #preloader {
      background-color: var(--color-preloader-bg);
      color: var(--color-text);
    }
<a id="" href="#"></a>
    #loader {
      border-color: var(--color-loader);
      border-top-color: transparent;
    }
<a id="" href="#"></a>
    /* Noscript warning */
    .noscript-warning {
      background-color: var(--color-primary);
      color: white;
      text-align: center;
      padding: 10px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
<a id="" href="#"></a>
    /* Theme indicator for no-JS */
    .theme-indicator {
      padding: 5px 10px;
      border-radius: 4px;
      background-color: var(--color-input-bg);
      color: var(--color-text);
      text-align: center;
    }
<a id="" href="#"></a>
    /* Hide JS-only elements when no JS */
    .no-js .js-only {
      display: none !important;
    }
<a id="" href="#"></a>
    /* Show no-JS alternatives */
    .js .no-js-only {
      display: none !important;
    }
  </style>
<a id="" href="#"></a>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="base-url" content="..">
  <title>simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework</title>
<a id="" href="#"></a>
  <!-- Critical CSS for fastest paint -->
  <style>
      .s-intro__title {
          visibility: visible;
          font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      .s-header {
          visibility: visible;
      }
<a id="" href="#"></a>
      /* Ensure theme toggle properly styled immediately */
      .theme-toggle {
          background-color: var(--color-background);
          color: var(--color-text);
      }
<a id="" href="#"></a>
      /* Control SVG visibility based on theme */
      [data-theme="dark"] .theme-toggle-icon.sun,
      :root:not([data-theme="dark"]) .theme-toggle-icon.moon {
          display: block;
      }
<a id="" href="#"></a>
      [data-theme="dark"] .theme-toggle-icon.moon,
      :root:not([data-theme="dark"]) .theme-toggle-icon.sun {
          display: none;
      }
  </style>
<a id="" href="#"></a>
  <!-- Critical Meta Tags -->
  <meta name="description" content="This module implements the diagonalization of 3D symmetric matrices through eigendecomposition, allowing the computation of eigenvalues and eigenvectors for ...">
  <meta name="author" content="CoMPhy Lab">
  <meta name="robots" content="index, follow">
  <meta name="keywords" content="checks, computes, eigen_decomposition.h, maps, math.h, stdlib.h, struct, testeigendecomposition, that, verifies">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-title" content="CoMPhy Lab">
<a id="" href="#"></a>
  <!-- Preload critical resources -->
  <link rel="preload" href="../assets/js/main.js" as="script">
  <link rel="preload" href="../assets/css/fontello/css/fontello.css" as="style">
  <link rel="preload" href="../assets/css/academicons-1.7.0/css/academicons.min.css" as="style">
<a id="" href="#"></a>
  <!-- Base stylesheets -->
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="stylesheet" href="../assets/css/custom_styles.css">
  <link rel="stylesheet" href="../assets/css/command-palette.css">
  <link rel="stylesheet" href="../assets/css/fontello/css/fontello.css">
  <link rel="stylesheet" href="../assets/css/academicons-1.7.0/css/academicons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
<a id="" href="#"></a>
  <!-- Font optimization -->
  <style>
      @font-face {
          font-display: swap;
          font-family: 'System Font';
          src: local('system-ui');
      }
  </style>
<a id="" href="#"></a>
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="96x96" href="../assets/favicon/favicon-96x96.png">
  <link rel="icon" type="image/svg+xml" href="../assets/favicon/favicon.svg">
  <link rel="shortcut icon" href="../assets/favicon/favicon.ico">
  <link rel="manifest" href="../assets/favicon/site.webmanifest">
<a id="" href="#"></a>
  <!-- Scripts with proper loading attributes -->
  <script src="../assets/js/jquery.min.js"></script>
  <script src="../assets/js/jquery-ui.packed.js"></script>
  <script src="../assets/js/plots.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
  <script defer src="../assets/js/command-palette.js"></script>
  <script defer src="../assets/js/command-data.js"></script>
  <script defer src="../assets/js/main.js"></script>
  <script defer src="../assets/js/theme-toggle.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
<a id="" href="#"></a>
  <!-- Optimize page load performance -->
  <script>
    // Preconnect to critical domains
    const preconnectDomains = [
      'https://cdnjs.cloudflare.com',
      'https://cdn.jsdelivr.net'
    ];
<a id="" href="#"></a>
    preconnectDomains.forEach(domain => {
      const link = document.createElement('link');
      link.rel = 'preconnect';
      link.href = domain;
      link.crossOrigin = 'anonymous';
      document.head.appendChild(link);
<a id="" href="#"></a>
      // Also add DNS prefetch as fallback
      const dnsLink = document.createElement('link');
      dnsLink.rel = 'dns-prefetch';
      dnsLink.href = domain;
      document.head.appendChild(dnsLink);
    });
<a id="" href="#"></a>
    // Detect when document is fully loaded to remove preloader
    window.addEventListener('load', function() {
      const preloader = document.getElementById('preloader');
      if (preloader) {
        preloader.style.opacity = '0';
        setTimeout(() => {
          preloader.style.display = 'none';
        }, 300); // Match transition duration
      }
    });
  </script>
<a id="" href="#"></a>
  <script>
      // Load Font Awesome with proper environment detection and fallbacks
      function loadStylesheet(href) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = href;
        link.crossOrigin = 'anonymous';
        link.onerror = (e) => {
          console.error(`Failed to load stylesheet: `, e);
          console.log('Trying alternative Font Awesome source...');
        };
        document.head.appendChild(link);
        return link;
      }
<a id="" href="#"></a>
      // Check if we're on localhost
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        // Use hardcoded version numbers for reliable loading
<a id="" href="#"></a>
        // Load Font Awesome using multiple CDNs to maximize reliability for local development
        loadStylesheet('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css');
        // Backup CDN if the first one fails
        loadStylesheet('https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css');
        // Final local fallback - ensures it will work on any localhost environment
        loadStylesheet('https://use.fontawesome.com/releases/v6.7.2/css/all.css');
      } else {
        // Use Kit for production with defer
        var script = document.createElement('script');
        script.src = 'https://kit.fontawesome.com/b1cfd9ca75.js';
        script.crossOrigin = 'anonymous';
        script.defer = true;
        document.head.appendChild(script);
      }
    </script>
<a id="" href="#"></a>
  <script>
      // Mark page as JS-enabled and manage transitions
      document.documentElement.classList.remove('no-js');
      document.documentElement.classList.add('js');
<a id="" href="#"></a>
      // Allow CSS transitions after initial load to prevent transition flashes
      window.addEventListener('DOMContentLoaded', () => {
          setTimeout(() => {
              document.documentElement.classList.add('transitions-enabled');
          }, 100); // Short delay to ensure DOM is ready
      });
  </script>
</head>
<body id="top">
<script>window.repoName = "Viscoelastic3D";</script>

<a id="" href="#"></a>
    <!-- Preloader with theme variables applied -->
    <div id="preloader">
        <div id="loader"></div>
    </div>
<a id="" href="#"></a>
    <noscript>
        <div class="noscript-warning">
            <p>This site works best with JavaScript enabled. Some features may be limited.</p>
        </div>
    </noscript>
<a id="" href="#"></a>
    <div id="page" class="s-pagewrap">
        <header class="s-header">
            <div class="s-header__logo">
                <a class="logo" href="/">
                    <img src="../assets/logos/CoMPhy-Lab-no-name.png" alt="CoMPhy Lab">
                </a>
                <a class="documentation-button" href="/Viscoelastic3D">
                    <i class="fa-solid fa-book-open"></i>
                    <span>Viscoelastic3D</span>
                </a>
            </div>
            <a class="s-header__menu-toggle" href="#0">
                <span class="s-header__menu-text">Menu</span>
                <span class="s-header__menu-icon"></span>
            </a>
            <nav class="s-header__nav">
                <a href="#0" class="s-header__nav-close-btn"><span>Close</span></a>
                <ul class="s-header__nav-list">
                    <li style="background: none;">
                        <!-- JS theme toggle -->
                        <div class="theme-toggle js-only" id="theme-toggle" aria-label="Toggle dark/light theme">
                            <svg class="theme-toggle-icon moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <svg class="theme-toggle-icon sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                        </div>
                    </li>
                    <li style="background: none;"><a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" style="background: none; padding: 0;" aria-label="Google Scholar Profile"><i class="ai ai-google-scholar" style="font-size: 1.75em;"></i></a></li>
                    <li style="background: none;"><a href="https://github.com/comphy-lab" style="background: none; padding: 0;" aria-label="GitHub Organization"><i class="fa-brands fa-github" style="font-size: 1.75em"></i></a></li>
                    <li><a href="https://comphy-lab.org/#about" class="smoothscroll">About</a></li>
                    <li><a href="https://comphy-lab.org/team/">Team</a></li>
                    <li><a href="https://comphy-lab.org/research">Research</a></li>
                    <li><a href="https://comphy-lab.org/teaching">Teaching</a></li>
                    <li><a href="https://comphy-lab.org/join">Join Us</a></li>
                    <li><a href="https://blogs.comphy-lab.org/">Blog</a></li>
                    <li style="background: none;"><a href="https://bsky.app/profile/comphy-lab.org" style="background: none; padding: 0;" aria-label="Bluesky Profile"><i class="fa-brands fa-bluesky" style="font-size: 1.75em; color: #0085ff;"></i></a></li>
                    <!-- Command Palette Button (Styled like search) -->
                    <li class="command-palette-button">
                        <div class="command-wrapper">
                            <button class="command-k-style-btn" id="command-palette-btn" aria-label="Open command palette">
                                <span class="default-theme-text">ctrl K</span>
                                <span class="mac-theme-text">⌘ K</span>
                                <i class="fa-solid fa-magnifying-glass search-icon"></i>
                            </button>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>
<a id="" href="#"></a>
        <!-- Main content -->
        <main class="content">
<a id="" href="#"></a>
            <div class="page-content">
<a id="" href="#"></a>
                                <h1 class="page-title">simulationCases/testEigenDecomposition.c</h1>
<a id="" href="#"></a>
<a id="" href="#"></a>
                                <div class="raw-file-button-container">
                    <a href="https://github.com/comphy-lab/Viscoelastic3D/raw/main/simulationCases/testEigenDecomposition.c" class="raw-file-button" target="_blank">
                        <i class="fa-brands fa-github"></i> See raw file
                    </a>
                </div>
<a id="" href="#"></a>
                <h1
                id="d-matrix-diagonalization-and-eigendecomposition">3D
                Matrix Diagonalization and Eigendecomposition</h1>
                <p>This module implements the diagonalization of 3D
                symmetric matrices through eigendecomposition, allowing
                the computation of eigenvalues and eigenvectors for 3x3
                symmetric matrices. The implementation follows standard
                linear algebra approaches to compute <span
                class="math inline">\(A = R \times \Lambda \times
                R^T\)</span> where:</p>
                <ul>
                <li><span class="math inline">\(A\)</span> is the
                original symmetric matrix</li>
                <li><span class="math inline">\(R\)</span> is the
                orthogonal matrix of eigenvectors</li>
                <li><span class="math inline">\(\Lambda\)</span> is the
                diagonal matrix of eigenvalues</li>
                </ul>
                <h2 id="numerical-parameters">Numerical Parameters</h2>
                <ul>
                <li>EPSILON: Used for floating-point comparisons to
                zero</li>
                <li>RELATIVE_TOLERANCE: Used for relative error checks
                in verification</li>
                </ul>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1-2"><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb1-3"><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb1-4"><span class="pp">#include </span><a href="../src-local/eigen_decomposition.h.html" title="Link to local documentation for eigen_decomposition.h"><span class="im">"eigen_decomposition.h"</span></a></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="pp">#define EPSILON </span><span class="fl">1e-9</span><span class="pp"></span><span class="dv">24</span><span class="pp"></span></span>
<span id="cb1-7"><span class="pp">#define RELATIVE_TOLERANCE </span><span class="fl">1e-6</span><span class="pp"></span><span class="dv">25</span><span class="pp"></span></span>
<span id="cb1-8"><span class="pp">#define sq</span><span class="op">(</span><span class="pp">x</span><span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="pp">x</span><span class="op">)*(</span><span class="pp">x</span><span class="op">))</span><span class="pp"></span><span class="dv">26</span><span class="pp"></span><span class="dv">27</span><span class="pp"></span></span></code></pre></div></div>
                <h2 id="data-structures">Data Structures</h2>
                <h3 id="d-vector">3D Vector</h3>
                <p>Represents a 3D vector with long double precision
                components.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">long</span> <span class="dt">double</span> x<span class="op">,</span> y<span class="op">,</span> z<span class="op">;</span> <span class="op">}</span> pseudo_v3d<span class="op">;</span></span></code></pre></div></div>
                <h3 id="d-tensormatrix">3D Tensor/Matrix</h3>
                <p>Represents a 3x3 matrix or tensor with long double
                precision components. Organized as three row vectors (x,
                y, z).</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> pseudo_v3d x<span class="op">,</span> y<span class="op">,</span> z<span class="op">;</span> <span class="op">}</span> pseudo_t3d<span class="op">;</span></span></code></pre></div></div>
                <h3 id="diagonalization_3d">diagonalization_3D</h3>
                <p>Performs eigendecomposition of a 3D symmetric
                matrix.</p>
                <p>This function computes the eigenvalues and
                eigenvectors of a 3x3 symmetric matrix using the
                eigen_decomposition function. It handles special cases
                where the matrix is already diagonal.</p>
                <p>Parameters: - Lambda: Output parameter to store the
                eigenvalues - R: Output parameter to store the
                eigenvectors as columns of R - A: Input symmetric matrix
                to be diagonalized</p>
                <p>The function maps the struct-based representation to
                arrays for computation and then maps the results back to
                the struct-based representation.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><span class="dt">static</span> <span class="dt">void</span> diagonalization_3D<span class="op">(</span>pseudo_v3d<span class="op">*</span> Lambda<span class="op">,</span> pseudo_t3d<span class="op">*</span> R<span class="op">,</span> pseudo_t3d<span class="op">*</span> A<span class="op">)</span></span>
<span id="cb4-2"><span class="op">{</span></span>
<span id="cb4-3">  <span class="co">// Check if the matrix is already diagonal</span></span>
<span id="cb4-4">  <span class="cf">if</span> <span class="op">(</span>sq<span class="op">(</span>A<span class="op">-&gt;</span>x<span class="op">.</span>y<span class="op">)</span> <span class="op">+</span> sq<span class="op">(</span>A<span class="op">-&gt;</span>x<span class="op">.</span>z<span class="op">)</span> <span class="op">+</span> sq<span class="op">(</span>A<span class="op">-&gt;</span>y<span class="op">.</span>z<span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-15</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-5">    R<span class="op">-&gt;</span>x<span class="op">.</span>x <span class="op">=</span> R<span class="op">-&gt;</span>y<span class="op">.</span>y <span class="op">=</span> R<span class="op">-&gt;</span>z<span class="op">.</span>z <span class="op">=</span> <span class="fl">1.</span><span class="op">;</span></span>
<span id="cb4-6">    R<span class="op">-&gt;</span>y<span class="op">.</span>x <span class="op">=</span> R<span class="op">-&gt;</span>x<span class="op">.</span>y <span class="op">=</span> R<span class="op">-&gt;</span>z<span class="op">.</span>x <span class="op">=</span> R<span class="op">-&gt;</span>x<span class="op">.</span>z <span class="op">=</span> R<span class="op">-&gt;</span>z<span class="op">.</span>y <span class="op">=</span> R<span class="op">-&gt;</span>y<span class="op">.</span>z <span class="op">=</span> <span class="fl">0.</span><span class="op">;</span></span>
<span id="cb4-7">    Lambda<span class="op">-&gt;</span>x <span class="op">=</span> A<span class="op">-&gt;</span>x<span class="op">.</span>x<span class="op">;</span> Lambda<span class="op">-&gt;</span>y <span class="op">=</span> A<span class="op">-&gt;</span>y<span class="op">.</span>y<span class="op">;</span> Lambda<span class="op">-&gt;</span>z <span class="op">=</span> A<span class="op">-&gt;</span>z<span class="op">.</span>z<span class="op">;</span></span>
<span id="cb4-8">    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-9">  <span class="op">}</span></span>
<span id="cb4-10"></span>
<span id="cb4-11">  <span class="co">// Compute eigenvalues using the eigen_decomposition function</span></span>
<span id="cb4-12">  <span class="dt">double</span> matrix<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb4-13">    <span class="op">{</span>A<span class="op">-&gt;</span>x<span class="op">.</span>x<span class="op">,</span> A<span class="op">-&gt;</span>x<span class="op">.</span>y<span class="op">,</span> A<span class="op">-&gt;</span>x<span class="op">.</span>z<span class="op">},</span></span>
<span id="cb4-14">    <span class="op">{</span>A<span class="op">-&gt;</span>x<span class="op">.</span>y<span class="op">,</span> A<span class="op">-&gt;</span>y<span class="op">.</span>y<span class="op">,</span> A<span class="op">-&gt;</span>y<span class="op">.</span>z<span class="op">},</span></span>
<span id="cb4-15">    <span class="op">{</span>A<span class="op">-&gt;</span>x<span class="op">.</span>z<span class="op">,</span> A<span class="op">-&gt;</span>y<span class="op">.</span>z<span class="op">,</span> A<span class="op">-&gt;</span>z<span class="op">.</span>z<span class="op">}</span></span>
<span id="cb4-16">  <span class="op">};</span></span>
<span id="cb4-17">  <span class="dt">double</span> eigenvectors<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb4-18">  <span class="dt">double</span> eigenvalues<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb4-19"></span>
<span id="cb4-20">  compute_eigensystem_symmetric_3x3<span class="op">(</span>matrix<span class="op">,</span> eigenvectors<span class="op">,</span> eigenvalues<span class="op">);</span></span>
<span id="cb4-21"></span>
<span id="cb4-22">  <span class="co">// Store eigenvalues and eigenvectors with proper index mapping</span></span>
<span id="cb4-23">  Lambda<span class="op">-&gt;</span>x <span class="op">=</span> eigenvalues<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb4-24">  Lambda<span class="op">-&gt;</span>y <span class="op">=</span> eigenvalues<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-25">  Lambda<span class="op">-&gt;</span>z <span class="op">=</span> eigenvalues<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb4-26"></span>
<span id="cb4-27">  R<span class="op">-&gt;</span>x<span class="op">.</span>x <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span> R<span class="op">-&gt;</span>x<span class="op">.</span>y <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span> R<span class="op">-&gt;</span>x<span class="op">.</span>z <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb4-28">  R<span class="op">-&gt;</span>y<span class="op">.</span>x <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span> R<span class="op">-&gt;</span>y<span class="op">.</span>y <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span> R<span class="op">-&gt;</span>y<span class="op">.</span>z <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb4-29">  R<span class="op">-&gt;</span>z<span class="op">.</span>x <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span> R<span class="op">-&gt;</span>z<span class="op">.</span>y <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span> R<span class="op">-&gt;</span>z<span class="op">.</span>z <span class="op">=</span> eigenvectors<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb4-30"><span class="op">}</span></span></code></pre></div></div>
                <h3 id="print_pseudo_t3d">print_pseudo_t3d</h3>
                <p>Prints a 3x3 matrix to standard output with
                formatting.</p>
                <p>Parameters: - name: Label for the matrix output -
                matrix: Pointer to the 3x3 matrix to be printed</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><span class="dt">void</span> print_pseudo_t3d<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span><span class="op">*</span> name<span class="op">,</span> <span class="dt">const</span> pseudo_t3d<span class="op">*</span> matrix<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-2">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">:</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> name<span class="op">);</span></span>
<span id="cb5-3">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf\n</span><span class="st">&quot;</span><span class="op">,</span> matrix<span class="op">-&gt;</span>x<span class="op">.</span>x<span class="op">,</span> matrix<span class="op">-&gt;</span>x<span class="op">.</span>y<span class="op">,</span> matrix<span class="op">-&gt;</span>x<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb5-4">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf\n</span><span class="st">&quot;</span><span class="op">,</span> matrix<span class="op">-&gt;</span>y<span class="op">.</span>x<span class="op">,</span> matrix<span class="op">-&gt;</span>y<span class="op">.</span>y<span class="op">,</span> matrix<span class="op">-&gt;</span>y<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb5-5">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf\n</span><span class="st">&quot;</span><span class="op">,</span> matrix<span class="op">-&gt;</span>z<span class="op">.</span>x<span class="op">,</span> matrix<span class="op">-&gt;</span>z<span class="op">.</span>y<span class="op">,</span> matrix<span class="op">-&gt;</span>z<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb5-6">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb5-7"><span class="op">}</span></span></code></pre></div></div>
                <h3 id="print_pseudo_v3d">print_pseudo_v3d</h3>
                <p>Prints a 3D vector to standard output with
                formatting.</p>
                <p>Parameters: - name: Label for the vector output -
                vector: Pointer to the 3D vector to be printed</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><span class="dt">void</span> print_pseudo_v3d<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span><span class="op">*</span> name<span class="op">,</span> <span class="dt">const</span> pseudo_v3d<span class="op">*</span> vector<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-2">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">: </span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf</span><span class="st"> </span><span class="sc">%12.9Lf\n\n</span><span class="st">&quot;</span><span class="op">,</span> name<span class="op">,</span> vector<span class="op">-&gt;</span>x<span class="op">,</span> vector<span class="op">-&gt;</span>y<span class="op">,</span> vector<span class="op">-&gt;</span>z<span class="op">);</span></span>
<span id="cb6-3"><span class="op">}</span></span></code></pre></div></div>
                <h3
                id="verify_orthonormality">verify_orthonormality</h3>
                <p>Verifies that the eigenvectors form an orthonormal
                basis.</p>
                <p>This function checks two key properties of
                eigenvectors: 1. Each eigenvector has unit norm
                (normalized) 2. Eigenvectors are mutually orthogonal
                (dot product is zero)</p>
                <p>Parameters: - R: Matrix containing eigenvectors as
                columns</p>
                <p>Returns: - 1 if eigenvectors are orthonormal - 0
                otherwise, with diagnostic messages printed to
                stdout</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><span class="dt">int</span> verify_orthonormality<span class="op">(</span><span class="dt">const</span> pseudo_t3d<span class="op">*</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb7-3">    <span class="dt">long</span> <span class="dt">double</span> norm <span class="op">=</span> sq<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">])</span> <span class="op">+</span> sq<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">3</span><span class="op">])</span></span>
<span id="cb7-4">                      <span class="op">+</span> sq<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb7-5">    <span class="cf">if</span> <span class="op">(</span>fabsl<span class="op">(</span>norm <span class="op">-</span> <span class="fl">1.0</span><span class="bu">L</span><span class="op">)</span> <span class="op">&gt;</span> EPSILON<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-6">      printf<span class="op">(</span><span class="st">&quot;Eigenvector </span><span class="sc">%d</span><span class="st"> is not normalized. Norm = </span><span class="sc">%Lf\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> sqrtl<span class="op">(</span>norm<span class="op">));</span></span>
<span id="cb7-7">      <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-8">    <span class="op">}</span></span>
<span id="cb7-9"></span>
<span id="cb7-10">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb7-11">      <span class="dt">long</span> <span class="dt">double</span> dot_product <span class="op">=</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>j<span class="op">]</span> <span class="op">+</span></span>
<span id="cb7-12">                                <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">3</span><span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>j<span class="op">+</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span></span>
<span id="cb7-13">                                <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">6</span><span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>j<span class="op">+</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb7-14">      <span class="cf">if</span> <span class="op">(</span>fabsl<span class="op">(</span>dot_product<span class="op">)</span> <span class="op">&gt;</span> EPSILON<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-15">        printf<span class="op">(</span><span class="st">&quot;Eigenvectors </span><span class="sc">%d</span><span class="st"> and </span><span class="sc">%d</span><span class="st"> are not orthogonal. Dot product = </span><span class="sc">%Lf\n</span><span class="st">&quot;</span><span class="op">,</span></span>
<span id="cb7-16">               i<span class="op">,</span> j<span class="op">,</span> dot_product<span class="op">);</span></span>
<span id="cb7-17">        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-18">      <span class="op">}</span></span>
<span id="cb7-19">    <span class="op">}</span></span>
<span id="cb7-20">  <span class="op">}</span></span>
<span id="cb7-21">  <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-22"><span class="op">}</span></span></code></pre></div></div>
                <h3
                id="verify_diagonalization">verify_diagonalization</h3>
                <p>Verifies that the matrix is properly diagonalized by
                computing R^T * A * R and checking if it approximates a
                diagonal matrix with eigenvalues.</p>
                <p>Parameters: - A: Original matrix - R: Matrix of
                eigenvectors - Lambda: Vector of eigenvalues</p>
                <p>Returns: - 1 if diagonalization is verified - 0
                otherwise, with diagnostic messages printed to
                stdout</p>
                <p>The function checks two properties: 1. Diagonal
                elements match the eigenvalues within relative tolerance
                2. Off-diagonal elements are approximately zero</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><span class="dt">int</span> verify_diagonalization<span class="op">(</span><span class="dt">const</span> pseudo_t3d<span class="op">*</span> A<span class="op">,</span> <span class="dt">const</span> pseudo_t3d<span class="op">*</span> R<span class="op">,</span></span>
<span id="cb8-2">                           <span class="dt">const</span> pseudo_v3d<span class="op">*</span> Lambda<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-3">  pseudo_t3d temp<span class="op">,</span> diagonalized<span class="op">;</span></span>
<span id="cb8-4"></span>
<span id="cb8-5">  <span class="co">// Compute R^T * A * R</span></span>
<span id="cb8-6">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-7">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-8">      <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-9">      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-10">        <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>k<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> i<span class="op">]</span> <span class="op">*</span></span>
<span id="cb8-11">                                          <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>k<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb8-12">      <span class="op">}</span></span>
<span id="cb8-13">    <span class="op">}</span></span>
<span id="cb8-14">  <span class="op">}</span></span>
<span id="cb8-15"></span>
<span id="cb8-16">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-17">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-18">      <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-19">      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-20">        <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> k<span class="op">]</span> <span class="op">*</span></span>
<span id="cb8-21">                                                 <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>k<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb8-22">      <span class="op">}</span></span>
<span id="cb8-23">    <span class="op">}</span></span>
<span id="cb8-24">  <span class="op">}</span></span>
<span id="cb8-25"></span>
<span id="cb8-26">  <span class="co">// Print the diagonalized matrix</span></span>
<span id="cb8-27">  print_pseudo_t3d<span class="op">(</span><span class="st">&quot;Diagonalized matrix: (R^T * A * R)&quot;</span><span class="op">,</span> <span class="op">&amp;</span>diagonalized<span class="op">);</span></span>
<span id="cb8-28"></span>
<span id="cb8-29">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-30">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb8-31">      <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-32">        <span class="dt">long</span> <span class="dt">double</span> relative_error <span class="op">=</span> fabsl<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">-</span></span>
<span id="cb8-33">                                    <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>Lambda<span class="op">)[</span>i<span class="op">])</span> <span class="op">/</span></span>
<span id="cb8-34">                                    <span class="op">(</span>fabsl<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>Lambda<span class="op">)[</span>i<span class="op">])</span> <span class="op">+</span> EPSILON<span class="op">);</span></span>
<span id="cb8-35">        <span class="cf">if</span> <span class="op">(</span>relative_error <span class="op">&gt;</span> RELATIVE_TOLERANCE<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-36">          printf<span class="op">(</span><span class="st">&quot;Diagonal element (</span><span class="sc">%d</span><span class="st">,</span><span class="sc">%d</span><span class="st">) does not match eigenvalue. </span><span class="sc">%Lf</span><span class="st"> != </span><span class="sc">%Lf</span><span class="st"> &quot;</span></span>
<span id="cb8-37">                 <span class="st">&quot;(relative error: </span><span class="sc">%Lf</span><span class="st">)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span></span>
<span id="cb8-38">                 i<span class="op">,</span> j<span class="op">,</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">],</span></span>
<span id="cb8-39">                 <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>Lambda<span class="op">)[</span>i<span class="op">],</span> relative_error<span class="op">);</span></span>
<span id="cb8-40">        <span class="op">}</span></span>
<span id="cb8-41">      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-42">        <span class="cf">if</span> <span class="op">(</span>fabsl<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">])</span> <span class="op">&gt;</span> EPSILON<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-43">          printf<span class="op">(</span><span class="st">&quot;Off-diagonal element (</span><span class="sc">%d</span><span class="st">,</span><span class="sc">%d</span><span class="st">) is not zero. Value = </span><span class="sc">%Lf\n</span><span class="st">&quot;</span><span class="op">,</span></span>
<span id="cb8-44">                 i<span class="op">,</span> j<span class="op">,</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>diagonalized<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]);</span></span>
<span id="cb8-45">        <span class="op">}</span></span>
<span id="cb8-46">      <span class="op">}</span></span>
<span id="cb8-47">    <span class="op">}</span></span>
<span id="cb8-48">  <span class="op">}</span></span>
<span id="cb8-49">  <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb8-50"><span class="op">}</span></span></code></pre></div></div>
                <h3 id="verify_eigenpairs">verify_eigenpairs</h3>
                <p>Verifies that <span class="math inline">\(A \times v
                = \lambda \times v\)</span> for each eigenpair.</p>
                <p>This function checks the fundamental eigenvalue
                equation by: 1. Computing <span class="math inline">\(A
                \times v\)</span> for each eigenvector 2. Computing
                <span class="math inline">\(\lambda \times v\)</span>
                for each eigenvector 3. Comparing the results for
                approximate equality</p>
                <p>Parameters: - A: Original matrix - R: Matrix
                containing eigenvectors as columns - Lambda: Vector of
                eigenvalues</p>
                <p>Returns: - 1 if all eigenpairs are verified - 0
                otherwise, with diagnostic messages printed to
                stdout</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><span class="dt">int</span> verify_eigenpairs<span class="op">(</span><span class="dt">const</span> pseudo_t3d<span class="op">*</span> A<span class="op">,</span> <span class="dt">const</span> pseudo_t3d<span class="op">*</span> R<span class="op">,</span></span>
<span id="cb9-2">                      <span class="dt">const</span> pseudo_v3d<span class="op">*</span> Lambda<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-3">  printf<span class="op">(</span><span class="st">&quot;Verifying A * v = λ * v for each eigenpair:</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb9-4">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-5">    pseudo_v3d Av <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">},</span> lambda_v <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb9-6"></span>
<span id="cb9-7">    <span class="co">// Compute A * v</span></span>
<span id="cb9-8">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-9">      <span class="op">((</span><span class="dt">double</span><span class="op">*)&amp;</span>Av<span class="op">)[</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>j<span class="op">*</span><span class="dv">3</span><span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">]</span> <span class="op">+</span></span>
<span id="cb9-10">                          <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>j<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">3</span><span class="op">]</span> <span class="op">+</span></span>
<span id="cb9-11">                          <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>j<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span><span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb9-12">    <span class="op">}</span></span>
<span id="cb9-13"></span>
<span id="cb9-14">    <span class="co">// Compute λ * v</span></span>
<span id="cb9-15">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-16">      <span class="op">((</span><span class="dt">double</span><span class="op">*)&amp;</span>lambda_v<span class="op">)[</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>Lambda<span class="op">)[</span>i<span class="op">]</span> <span class="op">*</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">+</span>j<span class="op">*</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb9-17">    <span class="op">}</span></span>
<span id="cb9-18"></span>
<span id="cb9-19">    printf<span class="op">(</span><span class="st">&quot;Eigenpair </span><span class="sc">%d</span><span class="st">:</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-20">    printf<span class="op">(</span><span class="st">&quot;A * v = </span><span class="sc">%8.4Lf</span><span class="st"> </span><span class="sc">%8.4Lf</span><span class="st"> </span><span class="sc">%8.4Lf\n</span><span class="st">&quot;</span><span class="op">,</span> Av<span class="op">.</span>x<span class="op">,</span> Av<span class="op">.</span>y<span class="op">,</span> Av<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb9-21">    printf<span class="op">(</span><span class="st">&quot;λ * v = </span><span class="sc">%8.4Lf</span><span class="st"> </span><span class="sc">%8.4Lf</span><span class="st"> </span><span class="sc">%8.4Lf\n</span><span class="st">&quot;</span><span class="op">,</span> lambda_v<span class="op">.</span>x<span class="op">,</span> lambda_v<span class="op">.</span>y<span class="op">,</span> lambda_v<span class="op">.</span>z<span class="op">);</span></span>
<span id="cb9-22"></span>
<span id="cb9-23">    <span class="co">// Check if A * v ≈ λ * v</span></span>
<span id="cb9-24">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb9-25">      <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(((</span><span class="dt">double</span><span class="op">*)&amp;</span>Av<span class="op">)[</span>j<span class="op">]</span> <span class="op">-</span> <span class="op">((</span><span class="dt">double</span><span class="op">*)&amp;</span>lambda_v<span class="op">)[</span>j<span class="op">])</span> <span class="op">&gt;</span> EPSILON<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-26">        printf<span class="op">(</span><span class="st">&quot;Mismatch for eigenpair </span><span class="sc">%d</span><span class="st">, component </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-27">      <span class="op">}</span></span>
<span id="cb9-28">    <span class="op">}</span></span>
<span id="cb9-29">    printf<span class="op">(</span><span class="st">&quot;Verification A * v = λ * v for each eigenpair done. &quot;</span></span>
<span id="cb9-30">           <span class="st">&quot;See the messages above!</span><span class="sc">\n\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb9-31">  <span class="op">}</span></span>
<span id="cb9-32">  <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-33"><span class="op">}</span></span></code></pre></div></div>
                <h3
                id="verify_eigendecomposition">verify_eigendecomposition</h3>
                <p>Main verification function that combines all
                verification tests.</p>
                <p>This function verifies the eigendecomposition by: 1.
                Checking orthonormality of eigenvectors 2. Verifying
                diagonalization (<span class="math inline">\(R^T \times
                A \times R \approx \Lambda\)</span>) 3. Confirming the
                eigenpair equation (<span class="math inline">\(A \times
                v = \lambda \times v\)</span>)</p>
                <p>Parameters: - A: Original matrix - R: Matrix of
                eigenvectors - Lambda: Vector of eigenvalues</p>
                <p>Returns: - 1 when verification completes - Messages
                about verification status are printed to stdout</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb10-1"><span class="dt">int</span> verify_eigendecomposition<span class="op">(</span><span class="dt">const</span> pseudo_t3d<span class="op">*</span> A<span class="op">,</span> <span class="dt">const</span> pseudo_t3d<span class="op">*</span> R<span class="op">,</span></span>
<span id="cb10-2">                             <span class="dt">const</span> pseudo_v3d<span class="op">*</span> Lambda<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-3">  <span class="cf">if</span> <span class="op">(!</span>verify_orthonormality<span class="op">(</span>R<span class="op">))</span> <span class="op">{</span></span>
<span id="cb10-4">    printf<span class="op">(</span><span class="st">&quot;Eigenvectors are not orthonormal.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-5">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-6">    printf<span class="op">(</span><span class="st">&quot;Eigenvectors are orthonormal.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-7">  <span class="op">}</span></span>
<span id="cb10-8">  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-9"></span>
<span id="cb10-10">  <span class="cf">if</span> <span class="op">(!</span>verify_diagonalization<span class="op">(</span>A<span class="op">,</span> R<span class="op">,</span> Lambda<span class="op">))</span> <span class="op">{</span></span>
<span id="cb10-11">    printf<span class="op">(</span><span class="st">&quot;Matrix is not properly diagonalized.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-12">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-13">    printf<span class="op">(</span><span class="st">&quot;Matrix is properly diagonalized.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-14">  <span class="op">}</span></span>
<span id="cb10-15"></span>
<span id="cb10-16">  <span class="cf">if</span> <span class="op">(!</span>verify_eigenpairs<span class="op">(</span>A<span class="op">,</span> R<span class="op">,</span> Lambda<span class="op">))</span> <span class="op">{</span></span>
<span id="cb10-17">    printf<span class="op">(</span><span class="st">&quot;Eigenpair verification failed.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-18">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-19">    printf<span class="op">(</span><span class="st">&quot;Eigenpair verification passed.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-20">  <span class="op">}</span></span>
<span id="cb10-21"></span>
<span id="cb10-22">  printf<span class="op">(</span><span class="st">&quot;Eigendecomposition verification completed. See the messages above!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb10-23">  <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-24"><span class="op">}</span></span></code></pre></div></div>
                <h3
                id="verify_reconstruction">verify_reconstruction</h3>
                <p>Verifies that <span class="math inline">\(A = R
                \times \Lambda \times R^T\)</span> by reconstructing
                <span class="math inline">\(A\)</span> from the
                eigendecomposition.</p>
                <p>This function: 1. Creates a diagonal matrix from the
                eigenvalues 2. Computes <span class="math inline">\(R
                \times \Lambda \times R^T\)</span> 3. Compares the
                result with the original matrix <span
                class="math inline">\(A\)</span></p>
                <p>Parameters: - A: Original matrix - R: Matrix of
                eigenvectors - Lambda: Vector of eigenvalues</p>
                <p>Returns: - 1 when verification completes -
                Differences between original and reconstructed matrices
                are printed to stdout</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><span class="dt">int</span> verify_reconstruction<span class="op">(</span><span class="dt">const</span> pseudo_t3d<span class="op">*</span> A<span class="op">,</span> <span class="dt">const</span> pseudo_t3d<span class="op">*</span> R<span class="op">,</span></span>
<span id="cb11-2">                         <span class="dt">const</span> pseudo_v3d<span class="op">*</span> Lambda<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-3">  pseudo_t3d Lambda_diag<span class="op">,</span> temp<span class="op">,</span> A_reconstructed<span class="op">;</span></span>
<span id="cb11-4"></span>
<span id="cb11-5">  <span class="co">// Create diagonal matrix from Lambda</span></span>
<span id="cb11-6">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-7">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-8">      <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>Lambda_diag<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span> <span class="op">?</span></span>
<span id="cb11-9">                                              <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>Lambda<span class="op">)[</span>i<span class="op">]</span> <span class="op">:</span> <span class="fl">0.0</span><span class="bu">L</span><span class="op">;</span></span>
<span id="cb11-10">    <span class="op">}</span></span>
<span id="cb11-11">  <span class="op">}</span></span>
<span id="cb11-12"></span>
<span id="cb11-13">  <span class="co">// Compute R * Lambda</span></span>
<span id="cb11-14">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-15">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-16">      <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-17">      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-18">        <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> k<span class="op">]</span> <span class="op">*</span></span>
<span id="cb11-19">                                          <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>Lambda_diag<span class="op">)[</span>k<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb11-20">      <span class="op">}</span></span>
<span id="cb11-21">    <span class="op">}</span></span>
<span id="cb11-22">  <span class="op">}</span></span>
<span id="cb11-23"></span>
<span id="cb11-24">  <span class="co">// Compute (R * Lambda) * R^T</span></span>
<span id="cb11-25">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-26">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-27">      <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>A_reconstructed<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-28">      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-29">        <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>A_reconstructed<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>temp<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> k<span class="op">]</span> <span class="op">*</span></span>
<span id="cb11-30">                                                    <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>R<span class="op">)[</span>j<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> k<span class="op">];</span></span>
<span id="cb11-31">      <span class="op">}</span></span>
<span id="cb11-32">    <span class="op">}</span></span>
<span id="cb11-33">  <span class="op">}</span></span>
<span id="cb11-34"></span>
<span id="cb11-35">  print_pseudo_t3d<span class="op">(</span><span class="st">&quot;Reconstructed A = R * Lambda * R^T&quot;</span><span class="op">,</span> <span class="op">&amp;</span>A_reconstructed<span class="op">);</span></span>
<span id="cb11-36"></span>
<span id="cb11-37">  <span class="co">// Compare original A with reconstructed A</span></span>
<span id="cb11-38">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-39">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb11-40">      <span class="dt">long</span> <span class="dt">double</span> diff <span class="op">=</span> fabsl<span class="op">(((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">-</span></span>
<span id="cb11-41">                              <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>A_reconstructed<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">]);</span></span>
<span id="cb11-42">      <span class="cf">if</span> <span class="op">(</span>diff <span class="op">&gt;</span> EPSILON<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-43">        printf<span class="op">(</span><span class="st">&quot;Mismatch at (</span><span class="sc">%d</span><span class="st">,</span><span class="sc">%d</span><span class="st">): original = </span><span class="sc">%Lf</span><span class="st">, reconstructed = </span><span class="sc">%Lf</span><span class="st">, &quot;</span></span>
<span id="cb11-44">               <span class="st">&quot;difference = </span><span class="sc">%Lf\n</span><span class="st">&quot;</span><span class="op">,</span></span>
<span id="cb11-45">               i<span class="op">,</span> j<span class="op">,</span> <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)</span>A<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">],</span></span>
<span id="cb11-46">               <span class="op">((</span><span class="dt">long</span> <span class="dt">double</span><span class="op">*)&amp;</span>A_reconstructed<span class="op">)[</span>i<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> j<span class="op">],</span> diff<span class="op">);</span></span>
<span id="cb11-47">      <span class="op">}</span></span>
<span id="cb11-48">    <span class="op">}</span></span>
<span id="cb11-49">  <span class="op">}</span></span>
<span id="cb11-50"></span>
<span id="cb11-51">  printf<span class="op">(</span><span class="st">&quot;A = R * Lambda * R^T verification completed. See the messages above!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb11-52">  <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-53"><span class="op">}</span></span></code></pre></div></div>
                <h2 id="main-function">Main Function</h2>
                <p>Entry point of the program that demonstrates matrix
                diagonalization and verification.</p>
                <p>The function: 1. Initializes a symmetric matrix A
                (default or from command line arguments) 2. Performs
                eigendecomposition to compute eigenvalues and
                eigenvectors 3. Runs verification procedures to confirm
                the correctness of the results</p>
                <p>Command-line usage:</p>
                <div class="code-block-container"><pre><code>./program A11 A12 A13 A22 A23 A33</code></pre></div>
                <p>Where A11…A33 are the elements of the symmetric
                matrix</p>
                <p>If no arguments are provided, a default matrix is
                used:</p>
                <div class="code-block-container"><pre><code>A = [ 1  2  3 ]
    [ 2  4  5 ]
    [ 3  5 -6 ]</code></pre></div>
                <p>Returns: - 0 on successful execution</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb14-2">  pseudo_t3d A<span class="op">,</span> R<span class="op">;</span></span>
<span id="cb14-3">  pseudo_v3d Lambda<span class="op">;</span></span>
<span id="cb14-4"></span>
<span id="cb14-5">  <span class="co">// Initialize A with the given values</span></span></code></pre></div></div>
                <h2 id="matrix-initialization-options">Matrix
                Initialization Options</h2>
                <p>Uncomment one of the following blocks to use a
                specific test matrix:</p>
                <h3 id="diagonal-not-identity-matrix">Diagonal (not
                identity) matrix:</h3>
                <div class="code-block-container"><pre><code>A.x.x = 1;  A.x.y = 0; A.x.z = 0;
A.y.x = 0; A.y.y = 2;  A.y.z = 0;
A.z.x = 0;  A.z.y = 0;  A.z.z = 3;</code></pre></div>
                <h3 id="identity-matrix">Identity matrix:</h3>
                <div class="code-block-container"><pre><code>A.x.x = 1;  A.x.y = 0; A.x.z = 0;
A.y.x = 0; A.y.y = 1;  A.y.z = 0;
A.z.x = 0;  A.z.y = 0;  A.z.z = 1;</code></pre></div>
                <h3 id="non-diagonal-matrix">Non-diagonal matrix:</h3>
                <div class="code-block-container"><pre><code>A.x.x = 1;  A.x.y = 2; A.x.z = 3;
A.y.x = 2; A.y.y = 4;  A.y.z = 5;
A.z.x = 3;  A.z.y = 5;  A.z.z = -6;</code></pre></div>
                <h3 id="small-magnitude-matrix">Small magnitude
                matrix:</h3>
                <div class="code-block-container"><pre><code>A.x.x = 1e-6;  A.x.y = 0; A.x.z = 0;
A.y.x = 0; A.y.y = 1e-12;  A.y.z = 0;
A.z.x = 0;  A.z.y = 0;  A.z.z = 1e-10;</code></pre></div>
                <h3 id="large-magnitude-matrix">Large magnitude
                matrix:</h3>
                <div class="code-block-container"><pre><code>A.x.x = 100;  A.x.y = 100; A.x.z = 10;
A.y.x = 100; A.y.y = 10;  A.y.z = 1;
A.z.x = 10;  A.z.y = 1;  A.z.z = 0.1;</code></pre></div>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb20-1">  <span class="cf">if</span> <span class="op">(</span>argc <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-2">    A<span class="op">.</span>x<span class="op">.</span>x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>  A<span class="op">.</span>x<span class="op">.</span>y <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> A<span class="op">.</span>x<span class="op">.</span>z <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb20-3">    A<span class="op">.</span>y<span class="op">.</span>x <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> A<span class="op">.</span>y<span class="op">.</span>y <span class="op">=</span> <span class="dv">4</span><span class="op">;</span>  A<span class="op">.</span>y<span class="op">.</span>z <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb20-4">    A<span class="op">.</span>z<span class="op">.</span>x <span class="op">=</span> <span class="dv">3</span><span class="op">;</span>  A<span class="op">.</span>z<span class="op">.</span>y <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>  A<span class="op">.</span>z<span class="op">.</span>z <span class="op">=</span> <span class="op">-</span><span class="dv">6</span><span class="op">;</span></span>
<span id="cb20-5">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb20-6">    <span class="co">// Get matrix elements from command line arguments</span></span>
<span id="cb20-7">    A<span class="op">.</span>x<span class="op">.</span>x <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">1</span><span class="op">]);</span>  A<span class="op">.</span>x<span class="op">.</span>y <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">2</span><span class="op">]);</span> A<span class="op">.</span>x<span class="op">.</span>z <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb20-8">    A<span class="op">.</span>y<span class="op">.</span>x <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">2</span><span class="op">]);</span> A<span class="op">.</span>y<span class="op">.</span>y <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">4</span><span class="op">]);</span>  A<span class="op">.</span>y<span class="op">.</span>z <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">5</span><span class="op">]);</span></span>
<span id="cb20-9">    A<span class="op">.</span>z<span class="op">.</span>x <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">3</span><span class="op">]);</span>  A<span class="op">.</span>z<span class="op">.</span>y <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">5</span><span class="op">]);</span>  A<span class="op">.</span>z<span class="op">.</span>z <span class="op">=</span> atof<span class="op">(</span>argv<span class="op">[</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb20-10">  <span class="op">}</span></span>
<span id="cb20-11"></span>
<span id="cb20-12">  print_pseudo_t3d<span class="op">(</span><span class="st">&quot;Original matrix A&quot;</span><span class="op">,</span> <span class="op">&amp;</span>A<span class="op">);</span></span>
<span id="cb20-13"></span>
<span id="cb20-14">  diagonalization_3D<span class="op">(&amp;</span>Lambda<span class="op">,</span> <span class="op">&amp;</span>R<span class="op">,</span> <span class="op">&amp;</span>A<span class="op">);</span></span>
<span id="cb20-15"></span>
<span id="cb20-16">  print_pseudo_t3d<span class="op">(</span><span class="st">&quot;Eigenvectors R&quot;</span><span class="op">,</span> <span class="op">&amp;</span>R<span class="op">);</span></span>
<span id="cb20-17">  print_pseudo_v3d<span class="op">(</span><span class="st">&quot;Eigenvalues Lambda&quot;</span><span class="op">,</span> <span class="op">&amp;</span>Lambda<span class="op">);</span></span>
<span id="cb20-18"></span>
<span id="cb20-19">  verify_eigendecomposition<span class="op">(&amp;</span>A<span class="op">,</span> <span class="op">&amp;</span>R<span class="op">,</span> <span class="op">&amp;</span>Lambda<span class="op">);</span></span>
<span id="cb20-20"></span>
<span id="cb20-21">  <span class="co">// Verify that A = R * Lambda * R^T</span></span>
<span id="cb20-22">  verify_reconstruction<span class="op">(&amp;</span>A<span class="op">,</span> <span class="op">&amp;</span>R<span class="op">,</span> <span class="op">&amp;</span>Lambda<span class="op">);</span></span>
<span id="cb20-23"></span>
<span id="cb20-24">  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb20-25"><span class="op">}</span></span></code></pre></div></div>
            </div>
        </main>
<a id="" href="#"></a>
        <footer class="site-footer">
            <div class="footer-left">
              <a href="http://basilisk.fr/sandbox/vatsal/" target="_blank">
                <img src="../assets/logos/logoBasilisk_TransparentBackground.png" alt="Basilisk C" class="footer-logo">
              </a>
              <a href="https://pof.tnw.utwente.nl/" target="_blank">
                <img src="../assets/logos/LogoPof_transparent_white.png" alt="Physics of Fluids" class="footer-logo pof-logo">
              </a>
              <a href="https://www.utwente.nl/" target="_blank">
                <img src="../assets/logos/UT_Logo_2400_Sta_White_EN.png" alt="University of Twente" class="footer-logo">
              </a>
              <a href="https://www.vatsalsanjay.com/" target="_blank">
                <img src="../assets/logos/Logo_Vatsal_v3_OutLine.png" alt="Vatsal Sanjay" class="footer-logo">
              </a>
            </div>
            <div class="footer-center">
              <p class="copyright-text">
                &copy; Copyright<br>
                CoMPhy Lab 2025
              </p>
            </div>
            <div class="footer-right">
              <a href="https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en" target="_blank" aria-label="Google Scholar Profile">
                <i class="ai ai-google-scholar" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab" target="_blank" aria-label="GitHub Organization">
                <i class="fa-brands fa-github" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://www.youtube.com/@CoMPhyLab" target="_blank" aria-label="YouTube Channel">
                <i class="fa-brands fa-youtube" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://x.com/VatsalSanjay" target="_blank" aria-label="X (Twitter) Profile">
                <i class="fa-brands fa-x-twitter" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://bsky.app/profile/comphy-lab.org" target="_blank" aria-label="Bluesky Profile">
                <i class="fa-brands fa-bluesky" style="font-size: 2.5em; color: white;"></i>
              </a>
              <a href="https://github.com/comphy-lab/comphy-lab.github.io" class="edit-link" aria-label="Edit this page on GitHub">
                <i class="fa-brands fa-github"></i> Edit this page
              </a>
            </div>
          </footer>
    </div>  
<a id="" href="#"></a>
    <!-- Command Palette -->
    <div id="simple-command-palette" class="simple-command-palette" style="display: none;">
        <div class="simple-command-palette-backdrop"></div>
        <div class="simple-command-palette-modal">
            <input type="text" id="command-palette-input" placeholder="Type a command..." autocomplete="off">
            <div id="command-palette-results" class="command-palette-results"></div>
            <div class="command-palette-footer">
                <span class="command-palette-footer-item"><kbd>↑</kbd> <kbd>↓</kbd> to navigate</span>
                <span class="command-palette-footer-item"><kbd>enter</kbd> to select</span>
                <span class="command-palette-footer-item"><kbd>esc</kbd> to close</span>
            </div>
        </div>
    </div>
<a id="" href="#"></a>

<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    // Add copy button to each code block container
    const codeBlocks = document.querySelectorAll('.code-block-container pre');
    codeBlocks.forEach(function(codeBlock, index) {
        // Create button element
        const button = document.createElement('button');
        button.className = 'copy-button';
        button.textContent = 'Copy';
        button.setAttribute('aria-label', 'Copy code to clipboard');
        button.setAttribute('data-copy-state', 'copy');
        
        // Get the code block container (parent of the pre)
        const container = codeBlock.parentNode;
        
        // Add the button to the container
        container.appendChild(button);
        
        // Set up click event
        button.addEventListener('click', async function() {
            const codeText = codeBlock.textContent;
            
            try {
                // Try to use the modern clipboard API first
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(codeText);
                    updateButtonState(button, 'success');
                } else {
                    // Fall back to the deprecated execCommand method
                    const textarea = document.createElement('textarea');
                    textarea.value = codeText;
                    textarea.style.position = 'fixed';  // Prevent scrolling to the bottom
                    document.body.appendChild(textarea);
                    textarea.select();
                    
                    const successful = document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    if (successful) {
                        updateButtonState(button, 'success');
                    } else {
                        updateButtonState(button, 'error');
                    }
                }
            } catch (err) {
                console.error('Copy failed:', err);
                updateButtonState(button, 'error');
            }
        });
    });
    
    // Function to update button state
    function updateButtonState(button, state) {
        if (state === 'success') {
            button.textContent = 'Copied!';
            button.classList.add('copied');
        } else if (state === 'error') {
            button.textContent = 'Error!';
            button.classList.add('error');
        }
        
        // Reset button state after 2 seconds
        setTimeout(function() {
            button.textContent = 'Copy';
            button.classList.remove('copied', 'error');
        }, 2000);
    }
});
</script>
        </body>
</html>
